"use client";
import{jsx as e}from"react/jsx-runtime";import{useLayoutEffect as t,useEffect as n,useRef as o,memo as r,useMemo as i,useReducer as s,forwardRef as l,useImperativeHandle as c}from"react";import{flushSync as a}from"react-dom";const h=Math.min,u=Math.max,f=Math.abs,d=Object.values,_=Array.isArray,g=setTimeout,p=(e,t,n)=>h(n,u(t,e)),v=e=>null!=e,m="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},w=e=>{let t,n;return(...o)=>(t||(t=!0,n=e(...o)),n)},S=-1,b=(e,t,n)=>{const o=n?"unshift":"push";for(let n=0;n<t;n++)e[o](S);return e},y=(e,t)=>{const n=e.t[t];return n===S?e.o:n},z=(e,t)=>{if(!e.i)return 0;if(e.l>=t)return e.h[t];e.l<0&&(e.h[0]=0,e.l=0);let n=e.l,o=e.h[n];for(;n<t;)o+=y(e,n),e.h[++n]=o;return e.l=t,o},x=(e,t,n)=>{let o=z(e,n);for(;n>=0&&n<e.i;)if(o<=t){const r=y(e,n);if(o+r>t)break;o+=r,n++}else o-=y(e,--n);return p(n,0,e.i-1)},I=(e,t,n,o)=>{const r=x(e,t,h(n,e.i-1));return[r,x(e,t+o,r)]},R=(e,t,n)=>{const o=t-e.i,r=o>0;let i;return r?(i=e.o*o,b(e.t,o,n),b(e.h,o)):(i=(n?e.t.splice(0,-o):e.t.splice(o)).reduce(((t,n)=>t+(n===S?e.o:n)),0),e.h.splice(o)),e.l=n?-1:h(t-1,e.l),e.i=t,[i,r]},k="undefined"!=typeof window,C=()=>document.documentElement,M=e=>e.ownerDocument,T=e=>e.defaultView,O=/*#__PURE__*/w((()=>!!k&&"rtl"===getComputedStyle(C()).direction)),E=/*#__PURE__*/w((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),H=/*#__PURE__*/w((()=>"scrollBehavior"in C().style)),J=e=>u(e.u(),e._()),W=(e,t,n)=>u(e-(1===n?1:u(1,t)),0),B=(e,t,n,o)=>h(e+(2===n?1:u(1,t)),o-1),$=(e,t,n)=>t.reduce(((t,[o,r])=>{const i=r-y(e,o);return(!n||i>0)&&(t+=i),t}),0),j=(e,t=40,n=0,o,r,i=0,s=0)=>{let l=!!n,c=[],a=0,d=0,_=0,g=0,v=0,m=!1,w=0,x=0,k=0,C=l?[0,u(n-1,0)]:null,M=[0,0];const T=o||((e,t)=>({o:t,i:e,l:-1,t:b([],e),h:b([],e)}))(e,t),O=new Set,H=()=>(e=>e.i?z(e,e.i-1)+y(e,e.i-1):0)(T),J=()=>H()+i+s,W=()=>u(0,J()-a),B=e=>{E()&&0!==x?v+=e:(g+=e,_++)};return{p:()=>c,v:()=>JSON.parse(JSON.stringify(T)),m:()=>C?[h(M[0],C[0]),u(M[1],C[1])]:w?M:M=I(T,d-i+v+g,M[0],a),S:e=>T.t[e]===S,I:()=>!!C&&T.t.slice(u(0,C[0]-1),h(T.i-1,C[1]+1)+1).includes(S),R:e=>z(T,e)-v,k:e=>y(T,e),C:()=>T.i,M:()=>d,T:()=>x,_:()=>a,O:()=>i,u:H,H:()=>_,J(){const e=g,t=m;return g=0,m=!1,a>J()?[0,!1]:[w=e,t]},W(e,t){const n=[e,t];return O.add(n),()=>{O.delete(n)}},B(e,t){let n,o,i=0;switch(e){case 1:{const e=t.filter((([e,t])=>T.t[e]!==t));if(!e.length)break;let n=0;if(0===d);else if(d>W()-1.5)n=$(T,e,!0);else if(2===k)n=$(T,e);else{const[t]=M;n=$(T,e.filter((([e])=>e<t)))}n&&B(n);let s=!1;e.forEach((([e,t])=>{((e,t,n)=>{const o=e.t[t]===S;return e.t[t]=n,e.l=h(t,e.l),o})(T,e,t)&&(s=!0)})),r&&s&&!d&&(e=>{const t=e.t.filter((e=>e!==S)),n=t[0];e.o=t.every((e=>e===n))?n:(e=>{const t=[...e].sort(((e,t)=>e-t)),n=e.length/2|0;return t.length%2==0?(t[n-1]+t[n])/2:t[n]})(t)})(T),i=2,o=!0;break}case 2:a!==t&&(a=t,i=2);break;case 3:if(t[1]){const e=W()-d,[n,o]=R(T,t[0],!0);B(o?n:-h(n,e)),o&&(k=2,m=!0),i=1}else R(T,t[0]);break;case 4:{const e=p(t,0,W()),n=w;if(w=0,e===d)break;const r=e-d,s=f(r);n&&s<f(n)+1||0!==k||(x=r<0?2:1),l&&(C=null,l=!1),o=s>a,d=e,i=5;break}case 5:i=8,0!==x&&(n=!0,i+=1),x=0,k=0,C=null;break;case 6:k=1;break;case 7:C=I(T,t,M[0],a),i=1}i&&(c=[],n&&v&&(g+=v,v=0,_++),O.forEach((([e,t])=>{i&e&&t(o)})))}}},A=k?t:n,D=(e,t)=>t&&O()?-e:e,L=(e,t,n,o,r)=>{const i=Date.now;let s=0,l=!1,c=!1,a=!1,h=!1;const u=(()=>{let t;const n=()=>{v(t)&&clearTimeout(t)},o=()=>{n(),t=g((()=>{t=null,(()=>{if(l||c)return l=!1,void u();a=!1,e.B(5)})()}),150)};return o.$=n,o})(),f=()=>{s=i(),a&&(h=!0),e.B(4,o()),u()},d=t=>{if(l||0===e.T()||t.ctrlKey)return;const o=i()-s;150>o&&50<o&&(n?t.deltaX:t.deltaY)&&(l=!0)},_=()=>{c=!0,a=h=!1},p=()=>{c=!1,E()&&(a=!0)};return t.addEventListener("scroll",f),t.addEventListener("wheel",d,{passive:!0}),t.addEventListener("touchstart",_,{passive:!0}),t.addEventListener("touchend",p,{passive:!0}),{j:()=>{t.removeEventListener("scroll",f),t.removeEventListener("wheel",d),t.removeEventListener("touchstart",_),t.removeEventListener("touchend",p),u.$()},A:()=>{const[t,n]=e.J();if(t)return r(t,h),h=!1,n}}},P=(e,t)=>{let n,o,r;const i=t?"scrollLeft":"scrollTop",s=t?"overflowX":"overflowY",l=async(o,s)=>{if(!n)return void m((()=>l(o,s)));r&&r();const c=()=>{let t;return[new Promise(((e,n)=>{t=e,g(r=n,150)})),e.W(2,(()=>{t&&t()}))]};if(s&&H()){for(;e.B(7,o()),e.I();){const[e,t]=c();try{await e}catch(e){return}finally{t()}}n.scrollTo({[t?"left":"top"]:D(o(),t),behavior:"smooth"})}else for(;;){const[r,s]=c();try{n[i]=D(o(),t),e.B(6),await r}catch(e){return}finally{s()}}};return{D(r){n=r,o=L(e,r,t,(()=>D(r[i],t)),((e,n)=>{if(n){const e=r.style,t=e[s];e[s]="hidden",g((()=>{e[s]=t}))}r[i]+=D(e,t)}))},j(){o&&o.j()},L(e){l((()=>e))},P(t){t+=e.M(),l((()=>t))},V(t,{align:n,smooth:o}={}){if(t=p(t,0,e.C()-1),"nearest"===n){const o=e.R(t),r=e.M();if(o<r)n="start";else{if(!(o+e.k(t)>r+e._()))return;n="end"}}l((()=>e.O()+("end"===n?e.R(t)+e.k(t)-e._():"center"===n?e.R(t)+(e.k(t)-e._())/2:e.R(t))),o)},A:()=>{o&&o.A()&&r&&r()}}},V=(e,t)=>{let n;return{D(o){const r=t?"scrollX":"scrollY",i=M(o),s=T(i),l=i.body,c=(e,t,n,o=0)=>{const r=n?"offsetLeft":"offsetTop",i=o+(n&&O()?s.innerWidth-e[r]-e.offsetWidth:e[r]),l=e.offsetParent;return e!==t&&l?c(l,t,n,i):i};n=L(e,s,t,(()=>D(s[r],t)-c(o,l,t)),(e=>{s.scrollBy(t?D(e,t):0,t?0:e)}))},j(){n&&n.j()},A:()=>{n&&n.A()}}},X="current",Y=(e,t)=>{if(_(e))for(const n of e)Y(n,t);else v(e)&&"boolean"!=typeof e&&t.push(e)},q=(e,t)=>{const n=e.key;return v(n)?n:"_"+t},N=e=>{const t=o();return t[X]||(t[X]=e())},U=e=>{const t=o(e);return A((()=>{t[X]=e}),[e]),t},F=e=>{let t;return{D(n){(t||(t=new(T(M(n)).ResizeObserver)(e))).observe(n)},X(e){t.unobserve(e)},j(){t&&t.disconnect()}}},G=(e,t)=>{let n;const o=t?"width":"height",r=new WeakMap,i=F((t=>{const i=[];for(const{target:s,contentRect:l}of t)if(s.offsetParent)if(s===n)e.B(2,l[o]);else{const e=r.get(s);v(e)&&i.push([e,l[o]])}i.length&&e.B(1,i)}));return{Y(e){i.D(n=e)},q:(e,t)=>(r.set(e,t),i.D(e),()=>{r.delete(e),i.X(e)}),j:i.j}},K=(e,t)=>{const n=t?"width":"height",o=t?"innerWidth":"innerHeight",r=new WeakMap,i=F((t=>{const o=[];for(const{target:e,contentRect:i}of t){if(!e.offsetParent)continue;const t=r.get(e);v(t)&&o.push([t,i[n]])}o.length&&e.B(1,o)}));let s;return{Y(t){const n=T(M(t)),r=()=>{e.B(2,n[o])};n.addEventListener("resize",r),r(),s=()=>{n.removeEventListener("resize",r)}},q:(e,t)=>(r.set(e,t),i.D(e),()=>{r.delete(e),i.X(e)}),j(){s&&s(),i.j()}}},Q=(e,t)=>{let n;const o="height",r="width",i=new WeakMap,s=new Set,l=new Set,c=new Map,a=(e,t)=>`${e}-${t}`,h=F((h=>{const f=new Set,d=new Set;for(const{target:s,contentRect:l}of h)if(s.offsetParent)if(s===n)e.B(2,l[o]),t.B(2,l[r]);else{const e=i.get(s);if(e){const[t,n]=e,i=a(t,n),s=c.get(i),h=[l[o],l[r]];let u,_;s?(s[0]!==h[0]&&(u=!0),s[1]!==h[1]&&(_=!0)):u=_=!0,u&&f.add(t),_&&d.add(n),(u||_)&&c.set(i,h)}}if(f.size){const t=[];f.forEach((e=>{let n=0;l.forEach((t=>{const o=c.get(a(e,t));o&&(n=u(n,o[0]))})),n&&t.push([e,n])})),e.B(1,t)}if(d.size){const e=[];d.forEach((t=>{let n=0;s.forEach((e=>{const o=c.get(a(e,t));o&&(n=u(n,o[1]))})),n&&e.push([t,n])})),t.B(1,e)}}));return{Y(e){h.D(n=e)},q:(e,t,n)=>(i.set(e,[t,n]),s.add(t),l.add(n),h.D(e),()=>{i.delete(e),h.X(e)}),j:h.j}},Z=/*#__PURE__*/r((({N:t,U:n,F:r,G:s,K:l,Z:c,ee:a,te:h})=>{const u=o(null);A((()=>n(u[X],r)),[r]);const f=i((()=>{const e={margin:0,padding:0,position:l&&h?void 0:"absolute",[a?"height":"width"]:"100%",[a?"top":"left"]:0,[a?O()?"right":"left":"top"]:s,visibility:!l||h?"visible":"hidden"};return a&&(e.display="flex"),e}),[s,l,h]);return e(c,"string"==typeof c?{ref:u,style:f,children:t}:{ref:u,style:f,index:r,children:t})})),ee=e=>s(e.p,void 0,e.p)[1],te=(e,t)=>i((()=>{if("function"==typeof e)return[e,t||0];const n=(e=>{const t=[];return Y(e,t),t})(e);return[e=>n[e],n.length]}),[e,t]),ne=/*#__PURE__*/l((({children:t,count:r,overscan:i=4,itemSize:s,shift:l,horizontal:h,cache:u,startMargin:f,endMargin:d,ssrCount:_,as:g="div",item:p="div",scrollRef:v,onScroll:w,onScrollEnd:S,onRangeChange:b},y)=>{const[z,x]=te(t,r),I=o(null),R=o(!!_),k=U(w),C=U(S),[M,T,O,E]=N((()=>{const e=!!h,t=j(x,s,_,u,!s,f,d);return[t,G(t,e),P(t,e),e]}));x!==M.C()&&M.B(3,[x,l]);const H=ee(M),[$,D]=M.m(),L=M.T(),V=M.H(),Y=M.u(),F=[];A((()=>{R[X]=!1;const e=M.W(3,(e=>{e?a(H):H()})),t=M.W(4,(()=>{k[X]&&k[X](M.M())})),n=M.W(8,(()=>{C[X]&&C[X]()})),o=e=>{T.Y(e),O.D(e)};return v?m((()=>o(v[X]))):o(I[X].parentElement),()=>{e(),t(),n(),T.j(),O.j()}}),[]),A((()=>{O.A()}),[V]),n((()=>{b&&b($,D)}),[$,D]),c(y,(()=>({get cache(){return M.v()},get scrollOffset(){return M.M()},get scrollSize(){return J(M)},get viewportSize(){return M._()},scrollToIndex:O.V,scrollTo:O.L,scrollBy:O.P})),[]);for(let t=W($,i,L),n=B(D,i,L,x);t<=n;t++){const n=z(t);F.push(e(Z,{U:T.q,F:t,G:M.R(t),K:M.S(t),Z:p,N:n,ee:E,te:R[X]},q(n,t)))}return e(g,{ref:I,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:E?Y:"100%",height:E?"100%":Y,pointerEvents:0!==L?"none":"auto"},children:F})})),oe=/*#__PURE__*/l((({children:t,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,reverse:c,cache:a,ssrCount:h,item:u,onScroll:f,onScrollEnd:d,onRangeChange:_,style:g,...p},v)=>{const m=o(null),w=c&&!l;let S=e(ne,{ref:v,scrollRef:w?m:void 0,count:n,overscan:r,itemSize:i,shift:s,horizontal:l,cache:a,ssrCount:h,item:u,onScroll:f,onScrollEnd:d,onRangeChange:_,children:t});return w&&(S=e("div",{style:{overflow:"hidden",visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:S})),e("div",{ref:m,...p,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...g},children:S})})),re=/*#__PURE__*/l((({children:t,count:r,overscan:i=4,itemSize:s,shift:l,horizontal:h,cache:u,ssrCount:f,as:d="div",item:_="div",onScrollEnd:g,onRangeChange:p},v)=>{const[m,w]=te(t,r),S=o(null),b=U(g),y=o(!!f),[z,x,I,R]=N((()=>{const e=!!h,t=j(w,s,f,u,!s);return[t,K(t,e),V(t,e),e]}));w!==z.C()&&z.B(3,[w,l]);const k=ee(z),[C,M]=z.m(),T=z.T(),O=z.H(),E=z.u(),H=[];A((()=>{y[X]=!1;const e=z.W(3,(e=>{e?a(k):k()})),t=z.W(8,(()=>{b[X]&&b[X]()})),n=S[X];return x.Y(n),I.D(n),()=>{e(),t(),x.j(),I.j()}}),[]),A((()=>{I.A()}),[O]),n((()=>{p&&p(C,M)}),[C,M]),c(v,(()=>({get cache(){return z.v()}})),[]);for(let t=W(C,i,T),n=B(M,i,T,w);t<=n;t++){const n=m(t);H.push(e(Z,{U:x.q,F:t,G:z.R(t),K:z.S(t),Z:_,N:n,ee:R,te:y[X]},q(n,t)))}return e(d,{ref:S,style:{flex:"none",position:"relative",visibility:"hidden",width:R?E:"100%",height:R?"100%":E,pointerEvents:0!==T?"none":"auto"},children:H})})),ie=/*#__PURE__*/l((({children:t,attrs:n,width:o,height:r,scrolling:s},l)=>e("div",{ref:l,...n,children:e("div",{style:i((()=>({position:"relative",visibility:"hidden",width:null!=o?o:"100%",height:null!=r?r:"100%",pointerEvents:s?"none":"auto"})),[o,r,s]),children:t})}))),se=(e,t)=>`${e}-${t}`,le=/*#__PURE__*/r((({N:t,U:n,ne:r,oe:s,re:l,ie:c,se:a,le:h,K:u,Z:f})=>{const d=o(null);return A((()=>n.q(d[X],r,s)),[s,r]),e(f,{ref:d,style:i((()=>({display:"grid",margin:0,padding:0,position:"absolute",top:l,[O()?"right":"left"]:c,visibility:u?"hidden":"visible",minHeight:a,minWidth:h})),[l,c,h,a,u]),children:t})})),ce=/*#__PURE__*/l((({children:t,row:n,col:r,cellHeight:s=40,cellWidth:l=100,overscan:h=2,initialRowCount:u,initialColCount:f,components:{Root:_=ie,Cell:g="div"}={},...p},v)=>{const[m,w,S,b,y]=N((()=>{const e=j(n,s,u),t=j(r,l,f);return[e,t,Q(e,t),P(e,!1),P(t,!0)]}));n!==m.C()&&m.B(3,[n]),r!==w.C()&&w.B(3,[r]);const z=ee(m),x=ee(w),[I,R]=m.m(),[k,C]=w.m(),M=m.T(),T=w.T(),O=m.H(),E=w.H(),H=J(m),$=J(w),D=o(null);A((()=>{const e=D[X],t=m.W(3,(e=>{e?a(z):z()})),n=w.W(3,(e=>{e?a(x):x()}));return S.Y(e),b.D(e),y.D(e),()=>{t(),n(),S.j(),b.j(),y.j()}}),[]),A((()=>{b.A()}),[O]),A((()=>{y.A()}),[E]),c(v,(()=>({get scrollOffset(){return[w.M(),m.M()]},get scrollSize(){return[J(w),J(m)]},get viewportSize(){return[w._(),m._()]},scrollToIndex(e,t){y.V(e),b.V(t)},scrollTo(e,t){y.L(e),b.L(t)},scrollBy(e,t){y.P(e),b.P(t)}})),[]);const L=i((()=>{const e=new Map;return(n,o)=>{let r=e.get(se(n,o));return r||e.set(se(n,o),r=t({rowIndex:n,colIndex:o})),r}}),[t]),V=W(I,h,M),Y=B(R,h,M,n),q=W(k,h,T),U=B(C,h,T,r),F=[];for(let t=V;t<=Y;t++)for(let n=q;n<=U;n++)F.push(e(le,{U:S,ne:t,oe:n,re:m.R(t),ie:w.R(n),se:m.k(t),le:w.k(n),K:m.S(t)||w.S(n),Z:g,N:L(t,n)},se(t,n)));return e(_,{ref:D,width:$,height:H,scrolling:0!==M||0!==T,attrs:i((()=>({...p,style:{overflow:"auto",overflowAnchor:"none",flex:"none",contain:"strict",width:"100%",height:"100%",...p.style}})),d(p)),children:F})}));export{oe as VList,ne as Virtualizer,re as WindowVirtualizer,ce as experimental_VGrid};
//# sourceMappingURL=index.mjs.map
