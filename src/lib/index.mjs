"use client";
import{jsx as e}from"react/jsx-runtime";import{useLayoutEffect as t,useEffect as n,useRef as r,memo as o,useMemo as i,useReducer as s,forwardRef as l,useImperativeHandle as c}from"react";import{flushSync as a}from"react-dom";const d=Math.min,h=Math.max,u=Math.abs,f=Object.values,_=Array.isArray,g=setTimeout,w=(e,t,n)=>d(n,h(t,e)),p=e=>null!=e,v=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},m=-1,S=(e,t,n)=>{const r=n?"unshift":"push";for(let n=0;n<t;n++)e[r](m);return e},b=(e,t)=>{const n=e.t[t];return n===m?e.o:n},z=(e,t)=>{if(!e.i)return 0;if(e.l>=t)return e.h[t];e.l<0&&(e.h[0]=0,e.l=0);let n=e.l,r=e.h[n];for(;n<t;)r+=b(e,n),e.h[++n]=r;return e.l=t,r},y=(e,t,n)=>{let r=z(e,n);for(;n>=0&&n<e.i;)if(r<=t){const o=b(e,n);if(r+o>t)break;r+=o,n++}else r-=b(e,--n);return w(n,0,e.i-1)},x=(e,t,n,r)=>{const o=y(e,t,d(n,e.i-1));return[o,y(e,t+r,o)]},R=(e,t,n)=>{const r=t-e.i,o=r>0;let i;return o?(i=e.o*r,S(e.t,r,n),S(e.h,r)):(i=(n?e.t.splice(0,-r):e.t.splice(r)).reduce(((t,n)=>t+(n===m?e.o:n)),0),e.h.splice(r)),e.l=n?-1:d(t-1,e.l),e.i=t,[i,o]},I="undefined"!=typeof window,C=()=>document.documentElement,k=/*#__PURE__*/v((e=>{const t="scrollLeft",n=e[t];e[t]=1;const r=e[t]<1;return e[t]=n,r})),O=/*#__PURE__*/v((()=>{return!!I&&"rtl"===(e=C(),getComputedStyle(e)).direction;var e})),M=/*#__PURE__*/v((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),T=/*#__PURE__*/v((()=>"scrollBehavior"in C().style)),E=e=>h(e.u(),e._()),H=(e,t,n)=>h(e-(1===n?1:h(1,t)),0),J=(e,t,n,r)=>d(e+(2===n?1:h(1,t)),r-1),W=(e,t,n)=>t.reduce(((t,[r,o])=>{const i=o-b(e,r);return(!n||i>0)&&(t+=i),t}),0),B=(e,t=40,n=0,r=((e,t)=>({o:t,i:e,l:-1,t:S([],e),h:S([],e)}))(e,t),o,i=0,s=0)=>{let l=!!n,c=[],a=0,f=0,_=0,g=0,p=0,v=0,y=0,I=0,C=l?[0,h(n-1,0)]:null,k=[0,0];const O=new Set,T=()=>(e=>e.i?z(e,e.i-1)+b(e,e.i-1):0)(r),E=()=>T()+i+s,H=()=>h(0,E()-a),J=e=>{M()&&0!==y?p+=e:(g+=e,_++)};return{p:()=>c,v:()=>JSON.parse(JSON.stringify(r)),m:()=>C?[d(k[0],C[0]),h(k[1],C[1])]:v?k:k=x(r,f-i+p+g,k[0],a),S:e=>r.t[e]===m,R:()=>!!C&&r.t.slice(h(0,C[0]-1),d(r.i-1,C[1]+1)+1).includes(m),I:e=>z(r,e)-p,C:e=>b(r,e),k:()=>r.i,O:()=>f,M:H,T:()=>y,_:()=>a,H:()=>i,J:()=>s,u:T,W:()=>_,B:()=>a>E()?g=0:(v=g,g=0,v),L(e,t){const n=[e,t];return O.add(n),()=>{O.delete(n)}},$(e,t){let n,i,s=0;switch(e){case 1:{const e=t.filter((([e,t])=>r.t[e]!==t));if(!e.length)break;let n=0;if(0===f);else if(f>H()-1.5)n=W(r,e,!0);else if(2===I)n=W(r,e);else{const[t]=k;n=W(r,e.filter((([e])=>e<t)))}n&&J(n);let l=!1;e.forEach((([e,t])=>{((e,t,n)=>{const r=e.t[t]===m;return e.t[t]=n,e.l=d(t,e.l),r})(r,e,t)&&(l=!0)})),o&&l&&!f&&(e=>{const t=e.t.filter((e=>e!==m)),n=t[0];e.o=t.every((e=>e===n))?n:(e=>{const t=[...e].sort(((e,t)=>e-t)),n=e.length/2|0;return t.length%2==0?(t[n-1]+t[n])/2:t[n]})(t)})(r),s=2,i=!0;break}case 2:a!==t&&(a=t,s=2);break;case 3:if(t[1]){const e=H()-f,[n,o]=R(r,t[0],!0);J(o?n:-d(n,e)),o&&(I=2),s=1}else R(r,t[0]);break;case 4:{const e=w(t,0,H()),n=v;if(v=0,e===f)break;const r=e-f,o=u(r);n&&o<u(n)+1||0!==I||(y=r<0?2:1),l&&(C=null,l=!1),i=o>a,f=e,s=5;break}case 5:s=8,0!==y&&(n=!0,s+=1),y=0,I=0,C=null;break;case 6:I=1;break;case 7:C=x(r,t,k[0],a),s=1}s&&(c=[],n&&p&&(g+=p,p=0,_++),O.forEach((([e,t])=>{s&e&&t(i)})))}}},L=I?t:n,$=(e,t,n,r)=>k(e)||r?-n:t.M()-n,A=(e,t,n,r,o)=>{let i=!1,s=!1,l=!1;const c=(()=>{let t;const n=()=>{p(t)&&clearTimeout(t)},r=()=>{n(),t=g((()=>{t=null,i?c():(s=!1,e.$(5))}),150)};return r.A=n,r})(),a=()=>{s&&(l=!0),e.$(4,r()),c()},d=(()=>{const t=Date.now;let r=t()-50;return o=>{const i=t();if(r+50<i){if(r=i,0===e.T()||o.ctrlKey)return;if(n?o.deltaX:o.deltaY){const t=e.O();t>0&&t<e.M()&&c()}}}})(),h=()=>{i=!0,s=l=!1},u=()=>{i=!1,M()&&(s=!0)};return t.addEventListener("scroll",a),t.addEventListener("wheel",d,{passive:!0}),t.addEventListener("touchstart",h,{passive:!0}),t.addEventListener("touchend",u,{passive:!0}),{P:()=>{t.removeEventListener("scroll",a),t.removeEventListener("wheel",d),t.removeEventListener("touchstart",h),t.removeEventListener("touchend",u),c.A()},V:e=>{o(e,l),l=!1}}},P=(e,t)=>{const n=t?"overflowX":"overflowY",r=e.style,o=r[n];r[n]="hidden",g((()=>{r[n]=o}))},V=(e,t)=>{let n,r,o;const i=t?"scrollLeft":"scrollTop",s=(r,o)=>t&&O()?$(n,e,r,o):r,l=async(r,l)=>{if(!n)return;o&&o();const c=()=>w(r(),0,e.M()),a=()=>{let t;return[new Promise(((e,n)=>{t=e,g(o=n,150)})),e.L(2,(()=>{t&&t()}))]};if(l&&T()){for(;e.$(7,c()),e.R();){const[e,t]=a();try{await e}catch(e){return}finally{t()}}n.scrollTo({[t?"left":"top"]:s(c()),behavior:"smooth"})}else for(;;){const[t,r]=a();try{n[i]=s(c()),e.$(6),await t}catch(e){return}finally{r()}}};return{X(o){n=o,r=A(e,o,t,(()=>s(o[i])),((e,n)=>{n&&P(o,t),o[i]+=s(e,!0)}))},P(){r&&r.P()},Y(e){l((()=>e))},j(t){t+=e.O(),l((()=>t))},D(t,{align:n,smooth:r}={}){if(t=w(t,0,e.k()-1),"nearest"===n){const r=e.I(t),o=e.O();if(r<o)n="start";else{if(!(r+e.C(t)>o+e._()))return;n="end"}}l((()=>e.H()+("end"===n?e.I(t)+e.C(t)-e._():"center"===n?e.I(t)+(e.C(t)-e._())/2:e.I(t))),r)},V:e=>{r&&r.V(e)}}},X=(e,t)=>{let n;return{X(r){const o=t?"scrollX":"scrollY",i=t?"offsetLeft":"offsetTop",s=(n,o)=>t&&O()?$(r,e,n,o):n,l=(e,n)=>{const r=n+(t&&O()?window.innerWidth-e[i]-e.offsetWidth:e[i]),o=e.offsetParent;return e!==document.body&&o?l(o,r):r};n=A(e,window,t,(()=>s(window[o])-l(r,0)),((e,n)=>{n&&P(document.body,t),window.scrollBy(t?s(e,!0):0,t?0:e)}))},P(){n&&n.P()},V:e=>{n&&n.V(e)}}},Y="current",j=(e,t)=>{if(_(e))for(const n of e)j(n,t);else p(e)&&"boolean"!=typeof e&&t.push(e)},D=(e,t)=>{const n=e.key;return p(n)?n:"_"+t},N=e=>{const t=r();return t[Y]||(t[Y]=e())},U=e=>{const t=r(e);return L((()=>{t[Y]=e}),[e]),t},F=(e,t)=>{let n;const r=t?"width":"height",o=new WeakMap,i=v((()=>new ResizeObserver((t=>{const i=[];for(const{target:s,contentRect:l}of t)if(s.offsetParent)if(s===n)e.$(2,l[r]);else{const e=o.get(s);p(e)&&i.push([e,l[r]])}i.length&&e.$(1,i)}))));return{N(e){i().observe(n=e)},U:(e,t)=>{const n=i();return o.set(e,t),n.observe(e),()=>{o.delete(e),n.unobserve(e)}},P(){i().disconnect()}}},G=(e,t)=>{const n=t?"width":"height",r=t?"innerWidth":"innerHeight",o=new WeakMap,i=v((()=>new ResizeObserver((t=>{const r=[];for(const{target:e,contentRect:i}of t){if(!e.offsetParent)continue;const t=o.get(e);p(t)&&r.push([t,i[n]])}r.length&&e.$(1,r)})))),s=()=>{e.$(2,window[r])};return{N(){window.addEventListener("resize",s),s()},U:(e,t)=>{const n=i();return o.set(e,t),n.observe(e),()=>{o.delete(e),n.unobserve(e)}},P(){window.removeEventListener("resize",s),i().disconnect()}}},q=(e,t)=>{let n;const r="height",o="width",i=new WeakMap,s=new Set,l=new Set,c=new Map,a=(e,t)=>`${e}-${t}`,d=v((()=>new ResizeObserver((d=>{const u=new Set,f=new Set;for(const{target:s,contentRect:l}of d)if(s.offsetParent)if(s===n)e.$(2,l[r]),t.$(2,l[o]);else{const e=i.get(s);if(e){const[t,n]=e,i=a(t,n),s=c.get(i),d=[l[r],l[o]];let h,_;s?(s[0]!==d[0]&&(h=!0),s[1]!==d[1]&&(_=!0)):h=_=!0,h&&u.add(t),_&&f.add(n),(h||_)&&c.set(i,d)}}if(u.size){const t=[];u.forEach((e=>{let n=0;l.forEach((t=>{const r=c.get(a(e,t));r&&(n=h(n,r[0]))})),n&&t.push([e,n])})),e.$(1,t)}if(f.size){const e=[];f.forEach((t=>{let n=0;s.forEach((e=>{const r=c.get(a(e,t));r&&(n=h(n,r[1]))})),n&&e.push([t,n])})),t.$(1,e)}}))));return{N(e){d().observe(n=e)},U(e,t,n){const r=d();return i.set(e,[t,n]),s.add(t),l.add(n),r.observe(e),()=>{i.delete(e),r.unobserve(e)}},P(){d().disconnect()}}},K=/*#__PURE__*/o((({F:t,G:n,q:o,K:s,Z:l,ee:c,te:a,ne:d})=>{const h=r(null);L((()=>n(h[Y],o)),[o]);const u=i((()=>{const e={margin:0,padding:0,position:l&&d?void 0:"absolute",[a?"height":"width"]:"100%",[a?"top":"left"]:0,[a?O()?"right":"left":"top"]:s,visibility:!l||d?"visible":"hidden"};return a&&(e.display="flex"),e}),[s,l,d]);return e(c,"string"==typeof c?{ref:h,style:u,children:t}:{ref:h,style:u,index:o,children:t})})),Q=e=>s(e.p,void 0,e.p)[1],Z=(e,t)=>i((()=>{if("function"==typeof e)return[e,t||0];const n=(e=>{const t=[];return j(e,t),t})(e);return[e=>n[e],n.length]}),[e,t]),ee=/*#__PURE__*/l((({children:t,count:o,overscan:i=4,itemSize:s,shift:l,horizontal:d,reverse:u,cache:f,startMargin:_,endMargin:g,ssrCount:w,as:p="div",item:v="div",scrollRef:m,onScroll:S,onScrollEnd:b,onRangeChange:z},y)=>{const[x,R]=Z(t,o),I=r(null),C=r(!!w),k=U(S),O=U(b),[M,T,W,$]=N((()=>{const e=!!d,t=B(R,s,w,f,!s,_,g);return[t,F(t,e),V(t,e),e]}));R!==M.k()&&M.$(3,[R,l]);const A=Q(M),[P,X]=M.m(),j=M.T(),G=M.W(),q=M.u(),ee=(e=>h(e.u(),e._()-e.H()-e.J()))(M),te=u?h(0,ee-q):0,ne=[];L((()=>{C[Y]=!1;const e=M.L(3,(e=>{e?a(A):A()})),t=M.L(4,(()=>{k[Y]&&k[Y](M.O())})),n=M.L(8,(()=>{O[Y]&&O[Y]()})),r=e=>{T.N(e),W.X(e)};return m?Promise.resolve().then((()=>r(m[Y]))):r(I[Y].parentElement),()=>{e(),t(),n(),T.P(),W.P()}}),[]),L((()=>{const e=M.B();e&&W.V(e)}),[G]),n((()=>{z&&z(P,X)}),[P,X]),c(y,(()=>({get cache(){return M.v()},get scrollOffset(){return M.O()},get scrollSize(){return E(M)},get viewportSize(){return M._()},scrollToIndex:W.D,scrollTo:W.Y,scrollBy:W.j})),[]);for(let t=H(P,i,j),n=J(X,i,j,R);t<=n;t++){const n=x(t);ne.push(e(K,{G:T.U,q:t,K:M.I(t)+te,Z:M.S(t),ee:v,F:n,te:$,ne:C[Y]},D(n,t)))}return e(p,{ref:I,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:$?q:"100%",height:$?"100%":q,[$?"minWidth":"minHeight"]:ee,pointerEvents:0!==j?"none":"auto"},children:ne})})),te=/*#__PURE__*/l((({children:t,count:n,overscan:r,itemSize:o,shift:i,horizontal:s,reverse:l,cache:c,ssrCount:a,item:d,onScroll:h,onScrollEnd:u,onRangeChange:f,style:_,...g},w)=>e("div",{...g,style:{display:s?"inline-block":"block",[s?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",..._},children:e(ee,{ref:w,count:n,overscan:r,itemSize:o,shift:i,horizontal:s,reverse:l,cache:c,ssrCount:a,item:d,onScroll:h,onScrollEnd:u,onRangeChange:f,children:t})}))),ne=/*#__PURE__*/l((({children:t,count:o,overscan:i=4,itemSize:s,shift:l,horizontal:d,cache:h,ssrCount:u,as:f="div",item:_="div",onScrollEnd:g,onRangeChange:w},p)=>{const[v,m]=Z(t,o),S=r(null),b=U(g),z=r(!!u),[y,x,R,I]=N((()=>{const e=!!d,t=B(m,s,u,h,!s);return[t,G(t,e),X(t,e),e]}));m!==y.k()&&y.$(3,[m,l]);const C=Q(y),[k,O]=y.m(),M=y.T(),T=y.W(),E=y.u(),W=[];L((()=>{z[Y]=!1;const e=y.L(3,(e=>{e?a(C):C()})),t=y.L(8,(()=>{b[Y]&&b[Y]()}));return x.N(),R.X(S[Y]),()=>{e(),t(),x.P(),R.P()}}),[]),L((()=>{const e=y.B();e&&R.V(e)}),[T]),n((()=>{w&&w(k,O)}),[k,O]),c(p,(()=>({get cache(){return y.v()}})),[]);for(let t=H(k,i,M),n=J(O,i,M,m);t<=n;t++){const n=v(t);W.push(e(K,{G:x.U,q:t,K:y.I(t),Z:y.S(t),ee:_,F:n,te:I,ne:z[Y]},D(n,t)))}return e(f,{ref:S,style:{flex:"none",position:"relative",visibility:"hidden",width:I?E:"100%",height:I?"100%":E,pointerEvents:0!==M?"none":"auto"},children:W})})),re=/*#__PURE__*/l((({children:t,attrs:n,width:r,height:o,scrolling:s},l)=>e("div",{ref:l,...n,children:e("div",{style:i((()=>({position:"relative",visibility:"hidden",width:null!=r?r:"100%",height:null!=o?o:"100%",pointerEvents:s?"none":"auto"})),[r,o,s]),children:t})}))),oe=(e,t)=>`${e}-${t}`,ie=/*#__PURE__*/o((({F:t,G:n,re:o,oe:s,ie:l,se:c,le:a,ce:d,Z:h,ee:u})=>{const f=r(null);return L((()=>n.U(f[Y],o,s)),[s,o]),e(u,{ref:f,style:i((()=>({display:"grid",margin:0,padding:0,position:"absolute",top:l,[O()?"right":"left"]:c,visibility:h?"hidden":"visible",minHeight:a,minWidth:d})),[l,c,d,a,h]),children:t})})),se=/*#__PURE__*/l((({children:t,row:n,col:o,cellHeight:s=40,cellWidth:l=100,overscan:d=2,initialRowCount:h,initialColCount:u,components:{Root:_=re,Cell:g="div"}={},...w},p)=>{const[v,m,S,b,z]=N((()=>{const e=B(n,s,h),t=B(o,l,u);return[e,t,q(e,t),V(e,!1),V(t,!0)]}));n!==v.k()&&v.$(3,[n]),o!==m.k()&&m.$(3,[o]);const y=Q(v),x=Q(m),[R,I]=v.m(),[C,k]=m.m(),O=v.T(),M=m.T(),T=v.W(),W=m.W(),$=E(v),A=E(m),P=r(null);L((()=>{const e=P[Y],t=v.L(3,(e=>{e?a(y):y()})),n=m.L(3,(e=>{e?a(x):x()}));return S.N(e),b.X(e),z.X(e),()=>{t(),n(),S.P(),b.P(),z.P()}}),[]),L((()=>{const e=v.B();e&&b.V(e)}),[T]),L((()=>{const e=m.B();e&&z.V(e)}),[W]),c(p,(()=>({get scrollOffset(){return[m.O(),v.O()]},get scrollSize(){return[E(m),E(v)]},get viewportSize(){return[m._(),v._()]},scrollToIndex(e,t){z.D(e),b.D(t)},scrollTo(e,t){z.Y(e),b.Y(t)},scrollBy(e,t){z.j(e),b.j(t)}})),[]);const X=i((()=>{const e=new Map;return(n,r)=>{let o=e.get(oe(n,r));return o||e.set(oe(n,r),o=t({rowIndex:n,colIndex:r})),o}}),[t]),j=H(R,d,O),D=J(I,d,O,n),U=H(C,d,M),F=J(k,d,M,o),G=[];for(let t=j;t<=D;t++)for(let n=U;n<=F;n++)G.push(e(ie,{G:S,re:t,oe:n,ie:v.I(t),se:m.I(n),le:v.C(t),ce:m.C(n),Z:v.S(t)||m.S(n),ee:g,F:X(t,n)},oe(t,n)));return e(_,{ref:P,width:A,height:$,scrolling:0!==O||0!==M,attrs:i((()=>({...w,style:{overflow:"auto",overflowAnchor:"none",flex:"none",contain:"strict",width:"100%",height:"100%",...w.style}})),f(w)),children:G})}));export{te as VList,ee as Virtualizer,ne as WindowVirtualizer,se as experimental_VGrid};
//# sourceMappingURL=index.mjs.map
